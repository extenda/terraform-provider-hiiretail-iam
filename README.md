# Terraform Provider for HiiRetail IAM

This Terraform provider allows you to manage HiiRetail IAM (Identity and Access Management) resources. Currently, it supports managing IAM groups with plans to expand to other IAM resources in the future.

## Requirements

- [Terraform](https://www.terraform.io/downloads.html) >= 1.0
- [Go](https://golang.org/doc/install) >= 1.21 (to build the provider plugin)

## Installation

To use the provider, add the following Terraform configuration:

```hcl
terraform {
  required_providers {
    hiiretail-iam = {
      source  = "extenda/hiiretail-iam"
      version = "~> 1.0.0"
    }
  }
}

provider "hiiretail-iam" {
  base_url = "https://iam-api.retailsvc.com/v1"  # Your HiiRetail IAM API endpoint
  token    = "your-api-token"                    # Your HiiRetail API token
}
```

## Usage Example

### Managing IAM Groups

```hcl
# Create a new IAM group
resource "hiiretail-iam_group" "developers" {
  name        = "developers"
  description = "Development team group"
}

# Import an existing group
resource "hiiretail-iam_group" "existing_admins" {
  # Use terraform import hiiretail-iam_group.existing_admins <group-id>
}
```

## Development Requirements

- Go 1.21+
- Terraform 1.0+
- Access to HiiRetail IAM API

### Building

1. Clone the repository
```bash
git clone https://github.com/extenda/terraform-provider-hiiretail-iam.git
cd terraform-provider-hiiretail-iam
```

2. Build the provider
```bash
go build
```

### Testing

To run the tests:

```bash
go test ./...
```

To run the acceptance tests (requires API access):

```bash
export HIIRETAIL_TOKEN="your-api-token"
export HIIRETAIL_API_URL="your-api-url"
TF_ACC=1 go test ./... -v
```

## Resource Documentation

### hiiretail-iam_group

Manages an IAM group in HiiRetail. Groups are collections of users that share the same access permissions.

#### Example Usage

```hcl
resource "hiiretail-iam_group" "example" {
  name        = "developers"
  description = "Development team group"
}
```

#### Argument Reference

* `name` - (Required) The name of the group. Must be between 3 and 128 characters, start with a letter, and contain only letters, numbers, hyphens (-), and underscores (_).
* `description` - (Required) A description of the group explaining its purpose. Must be between 1 and 256 characters.

#### Attribute Reference

* `id` - The unique identifier for the group. This is generated by HiiRetail when the group is created.

#### Import

IAM groups can be imported using their ID:

```bash
terraform import hiiretail-iam_group.example group-123456
```

## Error Handling

The provider includes comprehensive error handling with actionable error messages:

- Name conflicts are detected and reported with clear messages
- Resource not found cases are handled gracefully
- API errors include troubleshooting guidance
- Input validation provides clear requirements

## Contributing

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'feat: add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## License

This project is licensed under the MIT License - see the LICENSE file for details.